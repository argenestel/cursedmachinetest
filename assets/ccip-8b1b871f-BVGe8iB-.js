import{v as L,w as x,y as O,z as v,A as p,B as w,C as $,D as b,$ as g,V as y,L as h}from"./index-COQjmB9B.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},a=new Error().stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="0c537083-709b-4fc8-a20c-1fb45f997f43",e._sentryDebugIdIdentifier="sentry-dbid-0c537083-709b-4fc8-a20c-1fb45f997f43")}catch{}})();class D extends b{constructor({callbackSelector:a,cause:t,data:d,extraData:o,sender:l,urls:s}){var c;super(t.shortMessage||"An error occurred while fetching for an offchain result.",{cause:t,metaMessages:[...t.metaMessages||[],(c=t.metaMessages)!=null&&c.length?"":[],"Offchain Gateway Call:",s&&["  Gateway URL(s):",...s.map(u=>`    ${g(u)}`)],`  Sender: ${l}`,`  Data: ${d}`,`  Callback selector: ${a}`,`  Extra data: ${o}`].flat()}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"OffchainLookupError"})}}class C extends b{constructor({result:a,url:t}){super("Offchain gateway response is malformed. Response data must be a hex value.",{metaMessages:[`Gateway URL: ${g(t)}`,`Response: ${w(a)}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"OffchainLookupResponseMalformedError"})}}class R extends b{constructor({sender:a,to:t}){super("Reverted sender address does not match target contract address (`to`).",{metaMessages:[`Contract address: ${t}`,`OffchainLookup sender address: ${a}`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"OffchainLookupSenderMismatchError"})}}function S(e,a){if(!y(e,{strict:!1}))throw new h({address:e});if(!y(a,{strict:!1}))throw new h({address:a});return e.toLowerCase()===a.toLowerCase()}const j="0x556f1830",M={name:"OffchainLookup",type:"error",inputs:[{name:"sender",type:"address"},{name:"urls",type:"string[]"},{name:"callData",type:"bytes"},{name:"callbackFunction",type:"bytes4"},{name:"extraData",type:"bytes"}]};async function I(e,{blockNumber:a,blockTag:t,data:d,to:o}){const{args:l}=L({data:d,abi:[M]}),[s,c,u,r,n]=l,{ccipRead:i}=e,m=i&&typeof i?.request=="function"?i.request:T;try{if(!S(o,s))throw new R({sender:s,to:o});const f=await m({data:u,sender:s,urls:c}),{data:k}=await x(e,{blockNumber:a,blockTag:t,data:O([r,v([{type:"bytes"},{type:"bytes"}],[f,n])]),to:o});return k}catch(f){throw new D({callbackSelector:r,cause:f,data:d,extraData:n,sender:s,urls:c})}}async function T({data:e,sender:a,urls:t}){var d;let o=new Error("An unknown error occurred.");for(let l=0;l<t.length;l++){const s=t[l],c=s.includes("{data}")?"GET":"POST",u=c==="POST"?{data:e,sender:a}:void 0;try{const r=await fetch(s.replace("{sender}",a).replace("{data}",e),{body:JSON.stringify(u),method:c});let n;if((d=r.headers.get("Content-Type"))!=null&&d.startsWith("application/json")?n=(await r.json()).data:n=await r.text(),!r.ok){o=new p({body:u,details:n!=null&&n.error?w(n.error):r.statusText,headers:r.headers,status:r.status,url:s});continue}if(!$(n)){o=new C({result:n,url:s});continue}return n}catch(r){o=new p({body:u,details:r.message,url:s})}}throw o}export{T as ccipRequest,I as offchainLookup,M as offchainLookupAbiItem,j as offchainLookupSignature};
//# sourceMappingURL=ccip-8b1b871f-BVGe8iB-.js.map
